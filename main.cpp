#include <stdio.h>
#include <stdlib.h>  // rand, srand
#include <time.h>    // time
#include <Windows.h> // Sleep関数
#include <functional>

///===================================================================///
///                             main.cpp
///===================================================================///

///====================サイコロを振る関数====================///
/// NOTE: サイコロを振って奇数か偶数かを返す（1: 奇数, 0: 偶数）
int RollDice(int* dice) {

	// 1から6までのランダムな数
	*dice = ( rand() % 6 ) + 1;

	// 奇数なら1、偶数なら0
	return ( *dice % 2 == 0 ) ? 0 : 1;
}

///====================ゲームの処理を行う関数====================///
/// NOTE: プレイヤーの予想を受け取り、結果を判定する
void PlayGame(const std::function<void(int, int, int)>& callback) {
	int guess;

	// プレイヤーの入力を受付ける
	printf("奇数(1)か偶数(0)を予想してください: ");
	scanf_s("%d", &guess);

	// サイコロを振る
	int dice;
	int result = RollDice(&dice);

	// ラムダ式で結果を判定する
	callback(dice, result, guess);
}

///===================================================================///
///                           メイン処理
///===================================================================///
int main() {

	///----------------utf-8に設定----------------///
	SetConsoleOutputCP(65001);

	///----------------ゲーム処理----------------///
	// 乱数の種を設定
	srand(time(0));

	// ラムダ式を利用してコールバック関数を定義
	PlayGame([](int dice, int result, int guess) {
		printf("\n結果発表...\n");

		// 3秒待つ
		Sleep(3000);

		// サイコロの目を表示
		printf("サイコロの目は %d です。\n", dice);

		// 結果を判定
		if (result == guess) {
			printf("正解です！\n");
		} else {
			printf("不正解です。\n");
		}
		});

	///----------------終了処理----------------///
	return 0;
}
